<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>QResist Offline - SHA-3-512</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(
                    135deg,
                    #1a1a2e 0%,
                    #16213e 50%,
                    #0f3460 100%
                );
                color: #fff;
                min-height: 100vh;
                display: flex;
                justify-content: center;
                align-items: center;
                padding: 20px;
                line-height: 1.6;
            }
            .container {
                max-width: 700px;
                width: 100%;
                padding: 2.5rem;
                background: rgba(0, 0, 0, 0.4);
                border-radius: 20px;
                border: 1px solid rgba(255, 255, 255, 0.2);
                backdrop-filter: blur(15px);
                box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            }
            h1 {
                font-size: 2.5rem;
                font-weight: 300;
                background: linear-gradient(45deg, #00f5ff, #ff0080);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                margin-bottom: 1rem;
                text-align: center;
                letter-spacing: 1px;
            }
            .subtitle {
                text-align: center;
                margin-bottom: 2rem;
                color: #a0a0c0;
                font-weight: 300;
            }
            .input-group {
                margin-bottom: 1.5rem;
            }
            label {
                display: block;
                margin-bottom: 0.5rem;
                color: #a0a0c0;
                font-size: 0.9rem;
            }
            textarea {
                width: 100%;
                min-height: 120px;
                padding: 1.2rem;
                background: rgba(255, 255, 255, 0.08);
                border: 1px solid rgba(255, 255, 255, 0.2);
                border-radius: 10px;
                color: #fff;
                font-size: 1rem;
                resize: vertical;
                transition: all 0.3s ease;
            }
            textarea:focus {
                outline: none;
                border-color: rgba(0, 245, 255, 0.5);
                box-shadow: 0 0 15px rgba(0, 245, 255, 0.2);
                background: rgba(255, 255, 255, 0.12);
            }
            button {
                background: linear-gradient(45deg, #00f5ff, #0080ff);
                border: none;
                padding: 1.2rem 2.5rem;
                border-radius: 10px;
                color: white;
                font-size: 1.1rem;
                font-weight: 600;
                cursor: pointer;
                width: 100%;
                transition: all 0.3s ease;
                letter-spacing: 0.5px;
            }
            button:hover {
                transform: translateY(-3px);
                box-shadow: 0 8px 20px rgba(0, 245, 255, 0.4);
            }
            button:active {
                transform: translateY(0);
            }
            .output-label {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin: 1.5rem 0 0.5rem 0;
                color: #a0a0c0;
            }
            .copy-btn {
                background: rgba(255, 255, 255, 0.1);
                padding: 0.4rem 0.8rem;
                border-radius: 5px;
                font-size: 0.8rem;
                width: auto;
                margin: 0;
            }
            .copy-btn:hover {
                background: rgba(255, 255, 255, 0.2);
                transform: none;
                box-shadow: none;
            }
            #output {
                padding: 1.2rem;
                background: rgba(0, 0, 0, 0.4);
                border-radius: 10px;
                font-family: 'Courier New', monospace;
                font-size: 0.95rem;
                word-wrap: break-word;
                min-height: 70px;
                line-height: 1.5;
                border: 1px solid rgba(255, 255, 255, 0.1);
            }
            .footer {
                text-align: center;
                margin-top: 2rem;
                color: #6a6a8d;
                font-size: 0.8rem;
            }
            .instructions {
                margin-top: 1.5rem;
                padding: 1rem;
                background: rgba(0, 0, 0, 0.3);
                border-radius: 8px;
                font-size: 0.9rem;
                color: #a0a0c0;
            }
            .hashing {
                animation: pulse 1.5s infinite;
            }
            @keyframes pulse {
                0% {
                    opacity: 1;
                }
                50% {
                    opacity: 0.7;
                }
                100% {
                    opacity: 1;
                }
            }
            .success {
                color: #4ade80;
                font-weight: 500;
            }
            .hash-result {
                margin-top: 0.5rem;
                word-break: break-all;
            }
            .warning {
                color: #facc15;
                font-size: 0.85rem;
                margin-top: 0.5rem;
            }
            .copied {
                background: rgba(74, 222, 128, 0.3) !important;
                transition: background 0.2s;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>QResist Offline SHA-3-512</h1>
            <p class="subtitle">Secure SHA3-512 Hash Generator</p>
            <div class="input-group">
                <label for="input">Enter text to hash:</label
                ><textarea
                    id="input"
                    placeholder="Type your text here (e.g., I love my family)"></textarea>
                <div id="warning" class="warning" style="display: none">
                    Input >1MB: Computation may take time.
                </div>
            </div>
            <button id="hashBtn">Generate Hash</button>
            <div class="output-label">
                <span>SHA3-512 Hash:</span
                ><button id="copyBtn" class="copy-btn">Copy</button>
            </div>
            <div id="output">Your hash will appear here...</div>
            <div class="instructions">
                <p>
                    <strong>How it works:</strong> This tool generates a secure
                    SHA3-512 hash of your input text. The computation happens
                    entirely in your browser - no data is sent to any server.
                </p>
            </div>
            <div class="footer">
                <p>QResist Offline Tool | Secure Hashing</p>
            </div>
        </div>
        <script>
            function sha3_512(e) {
                const t = 24,
                    a = [
                        1, 3, 6, 10, 15, 21, 28, 36, 45, 55, 2, 14, 27, 41, 56,
                        8, 25, 43, 62, 18, 39, 61, 20, 44
                    ],
                    r = [
                        10, 7, 11, 17, 18, 3, 5, 16, 8, 21, 24, 4, 15, 23, 19,
                        13, 12, 2, 20, 14, 22, 9, 6, 1
                    ],
                    n = new TextEncoder(),
                    o = n.encode(e),
                    s = 576,
                    c = 1024,
                    i = 512,
                    l = s / 8
                let d = new Array(25).fill(0n)
                const u = pad10Star1(o, l)
                for (let e = 0; e < u.length; e += l)
                    for (let t = 0; t < l; t += 8) {
                        const a = bytesToWord(u.slice(e + t, e + t + 8))
                        d[Math.floor(t / 8)] ^= a
                    }
                d = keccakF(d, t, a, r)
                let h = ''
                for (let e = 0; e < i / 64; e++) h += wordToHex(d[e])
                return h
            }
            function pad10Star1(e, t) {
                const a = e.length
                let r = t - (a % t)
                r === 0 && (r = t)
                const n = new Uint8Array(a + r)
                n.set(e)
                const o = a
                n[o] |= 0x80
                n[n.length - 1] |= 0x01
                n[n.length - 1] ^= 0x06
                return n
            }
            function bytesToWord(e) {
                let t = 0n
                for (let a = 0; a < Math.min(8, e.length); a++)
                    t += BigInt(e[a]) << BigInt(8 * a)
                return t
            }
            function wordToHex(e) {
                let t = e.toString(16)
                for (; t.length < 16; ) t = '0' + t
                return t
            }
            function keccakF(e, t, a, r) {
                const n = [
                    0x0000000000000001n,
                    0x0000000000008082n,
                    0x800000000000808an,
                    0x8000000080008000n,
                    0x000000000000808bn,
                    0x0000000080000001n,
                    0x8000000080008081n,
                    0x8000000000008009n,
                    0x000000000000008an,
                    0x0000000000000088n,
                    0x0000000080008009n,
                    0x000000008000000an,
                    0x000000008000808bn,
                    0x800000000000008bn,
                    0x8000000000008089n,
                    0x8000000000008003n,
                    0x8000000000008002n,
                    0x8000000000000080n,
                    0x000000000000800an,
                    0x800000008000000an,
                    0x8000000080008081n,
                    0x8000000000008080n,
                    0x0000000080000001n,
                    0x8000000080008008n
                ]
                for (let o = 0; o < t; o++) {
                    const t = new Array(5).fill(0n),
                        s = new Array(5).fill(0n)
                    for (let a = 0; a < 5; a++)
                        t[a] =
                            e[a] ^ e[a + 5] ^ e[a + 10] ^ e[a + 15] ^ e[a + 20]
                    for (let a = 0; a < 5; a++)
                        s[a] = t[(a + 4) % 5] ^ rot64(t[(a + 1) % 5], 1)
                    for (let a = 0; a < 5; a++)
                        for (let r = 0; r < 5; r++) e[a + 5 * r] ^= s[a]
                    let c = e[1]
                    for (let t = 0; t < 24; t++) {
                        const n = r[t],
                            o = e[n]
                        e[n] = rot64(c, a[t])
                        c = o
                    }
                    for (let t = 0; t < 5; t++) {
                        const a = 5 * t,
                            r = [e[a], e[a + 1], e[a + 2], e[a + 3], e[a + 4]]
                        for (let n = 0; n < 5; n++)
                            e[a + n] = r[n] ^ (~r[(n + 1) % 5] & r[(n + 2) % 5])
                    }
                    e[0] ^= n[o]
                }
                return e
            }
            function rot64(e, t) {
                t %= 64
                return (
                    ((e << BigInt(t)) | (e >> BigInt(64 - t))) &
                    0xffffffffffffffffn
                )
            }
            ;(function () {
                'use strict'
                const e = document.getElementById('input'),
                    t = document.getElementById('output'),
                    a = document.getElementById('hashBtn'),
                    r = document.getElementById('copyBtn'),
                    n = document.getElementById('warning')
                function o() {
                    n.style.display =
                        e.value.length > 1048576 ? 'block' : 'none'
                }
                e.addEventListener('input', o)
                a.addEventListener('click', () => {
                    let r = e.value.trim()
                    r.length === 0 && (r = e.value)
                    try {
                        a.textContent = 'Hashing...'
                        a.classList.add('hashing')
                        a.disabled = !0
                        setTimeout(() => {
                            const e = sha3_512(r)
                            t.innerHTML = `<div class="success">Hash generated successfully!</div><div class="hash-result">${e}</div>`
                            a.textContent = 'Generate Hash'
                            a.classList.remove('hashing')
                            a.disabled = !1
                        }, 10)
                    } catch (e) {
                        t.textContent = 'Error: ' + e.message
                        a.textContent = 'Generate Hash'
                        a.classList.remove('hashing')
                        a.disabled = !1
                    }
                })
                r.addEventListener('click', () => {
                    const e = t.querySelector('.hash-result')
                    if (e) {
                        const t = e.textContent
                        navigator.clipboard
                            .writeText(t)
                            .then(() => {
                                const e = r.textContent
                                r.textContent = 'Copied!'
                                r.classList.add('copied')
                                setTimeout(() => {
                                    r.textContent = e
                                    r.classList.remove('copied')
                                }, 2000)
                            })
                            .catch((e) => {
                                console.error('Failed to copy: ', e)
                            })
                    }
                })
                e.addEventListener('keypress', (e) => {
                    e.key === 'Enter' &&
                        !e.shiftKey &&
                        (e.preventDefault(), a.click())
                })
                window.addEventListener('load', () => {
                    a.click()
                })
                Object.freeze(console)
                o()
            })()
        </script>
    </body>
</html>
